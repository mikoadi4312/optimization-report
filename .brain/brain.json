{
    "meta": {
        "schema_version": "1.1.0",
        "awf_version": "3.3.0",
        "updated_at": "2026-02-12T16:40:00+07:00"
    },
    "project": {
        "name": "Optimization Report",
        "type": "Web Application",
        "status": "Development",
        "description": "Aplikasi pelaporan optimalisasi untuk manajemen toko, mencakup laporan FIFO, transfer barang, deposit manual, dan kinerja staf."
    },
    "tech_stack": {
        "frontend": {
            "framework": "React (Vite)",
            "language": "TypeScript",
            "styling": "Tailwind CSS",
            "icons": "Lucide React",
            "charts": "Recharts"
        },
        "backend": {
            "runtime": "Cloudflare Pages Functions",
            "database": "Cloudflare D1 (SQLite)",
            "orm": "Drizzle ORM (migrasi manual)",
            "file_processing": "ExcelJS"
        },
        "deployment": {
            "platform": "Cloudflare Pages",
            "build_command": "npm run build",
            "output_dir": "dist"
        }
    },
    "database_schema": {
        "summary": "Database SQLite di Cloudflare D1 untuk menyimpan data transaksi deposit manual.",
        "tables": [
            {
                "name": "deposit_transactions",
                "columns": [
                    {
                        "name": "id",
                        "type": "INTEGER",
                        "primary_key": true,
                        "auto_increment": true
                    },
                    {
                        "name": "store_code",
                        "type": "TEXT"
                    },
                    {
                        "name": "voucher_no",
                        "type": "TEXT",
                        "unique": true
                    },
                    {
                        "name": "customer_name",
                        "type": "TEXT"
                    },
                    {
                        "name": "date",
                        "type": "TEXT"
                    },
                    {
                        "name": "amount",
                        "type": "REAL"
                    },
                    {
                        "name": "type",
                        "type": "TEXT"
                    },
                    {
                        "name": "reference",
                        "type": "TEXT"
                    },
                    {
                        "name": "content",
                        "type": "TEXT"
                    },
                    {
                        "name": "created_at",
                        "type": "TIMESTAMP",
                        "default": "CURRENT_TIMESTAMP"
                    }
                ],
                "relationships_explained": "Tabel tunggal untuk menyimpan riwayat transaksi deposit manual yang diunggah dari Excel."
            }
        ]
    },
    "api_endpoints": [
        {
            "path": "/api/deposit",
            "method": "GET",
            "description": "Mengambil semua data transaksi deposit dari database.",
            "response": "Array of ApiTransaction objects"
        },
        {
            "path": "/api/deposit",
            "method": "POST",
            "description": "Menyimpan data transaksi baru ke database. Mendukung batch upload.",
            "body": "Array of ApiTransaction objects",
            "response": "{ success: boolean, count: number, message: string }"
        }
    ],
    "features": [
        {
            "name": "Deposit Manual Report",
            "status": "Implemented",
            "description": "Upload file Excel Deposit & AM, validasi data, deteksi duplikat, dan simpan ke Cloudflare D1."
        },
        {
            "name": "Staff FIFO Mistake",
            "status": "Implemented",
            "description": "Laporan kesalahan FIFO staf berdasarkan pencocokan IMEI."
        },
        {
            "name": "Transfer Goods Report",
            "status": "Implemented",
            "description": "Laporan keterlambatan transfer barang antar toko."
        },
        {
            "name": "Revenue Staff Report",
            "status": "Implemented",
            "description": "Laporan performa pendapatan staf bulanan."
        }
    ],
    "knowledge_items": {
        "patterns": [
            "File Upload & Processing di Client-side (React + ExcelJS)",
            "Serverless Backend dengan Cloudflare Pages Functions",
            "Database D1 dengan akses via binding 'DB'"
        ],
        "gotchas": [
            "Local Wrangler D1 bersifat ephemeral (hilang saat restart) kecuali dipersisting, tapi tabel perlu dibuat ulang jika db file terhapus.",
            "Wrangler local development environment issue: `db.exec()` bisa menyebabkan error `undefined reading 'duration'`, gunakan `db.prepare().run()` sebagai gantinya."
        ],
        "conventions": [
            "Komponen UI reusable di folder `components/`",
            "Logika bisnis laporan di folder `services/reports/`",
            "API handlers di folder `functions/api/`"
        ]
    }
}